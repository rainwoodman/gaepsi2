"""
Color map in Gaepsi

We do not deligate to matplotlib's color map in this module

N and NL can produce some large arrays (2x original)

the only colormap is CoolWarm

CoolWarm(color, brightness) returns rgb in u1.
color and brightness shall be normalized to 0, 1; 
out of bound numbers are satuated (numpy.interp)

"""
import numpy

def N(a, range=None):
    """ normalize array, so that max -> 1, min-> 0
        max, min given by range

        range can be a scalar (min = max - scalar) 
        range can be a tuple (the min and the max)
        range can be None (min max from data)

        nan is skipped.
    """
    if range is not None:
        if numpy.isscalar(range):
            amax = numpy.nanmax(a)
            amin = amax + range
        #    print 'scalar range', range
        else:
            amin, amax = range
    else:
        amin = numpy.nanmin(a)
        amax = numpy.nanmax(a)
    a = a - amin
    a /= (amax - amin)
    return a

def NL(a, range=None):
    """ normalize array in logscale, so that max -> 1, min-> 0
        max, min given by range

        range can be a scalar (min = max - scalar) 
        range can be a tuple (the min and the max)
        range can be None (min max from data)

        nan is skipped.
    """
    a = numpy.log10(a)
    a[numpy.isneginf(a)] = numpy.nan
    return N(a, range)

class Colormap(object):
    def __init__(self, map):
        self.map = map
        assert map.shape[1] == 3
        self.x = numpy.linspace(0, 1.0, len(map), endpoint=True)

    @classmethod
    def from_mpl(self, mpl):
        return Colormap(mpl(numpy.linspace(0, 1.0, 8192, endpoint=True))[:, :3])

    def __call__(self, data, brightness=1.0):
        value = numpy.empty(list(data.shape) + [4], 'u1')
        data2 = data.copy()
        data2[numpy.isnan(data)] = 0.
        for i in range(3):
            tmp = brightness * numpy.interp(data, self.x, self.map[:, i]) * 255
            numpy.clip(tmp, 0, 255, out=tmp)
            value[..., i] = numpy.uint8(tmp)
        value[..., 3] = 255
        return value

def setup():
    global CoolWarm
    global CoolWarmR
    global Hot
    global HotR
    from io import StringIO
    CoolWarm = Colormap(numpy.loadtxt(StringIO(coolwarm_data)))
    CoolWarmR = Colormap(numpy.loadtxt(StringIO(coolwarm_data))[::-1])
    Hot = Colormap(numpy.loadtxt(StringIO(hot_data)))
    HotR = Colormap(numpy.loadtxt(StringIO(hot_data))[::-1])

coolwarm_data = """
2.298057000000000016e-01 2.987179660000000014e-01 7.536831529999999946e-01
2.343770794509803801e-01 3.055417303294117870e-01 7.596795275882353149e-01
2.389484589019607863e-01 3.123654946588235171e-01 7.656759021764705242e-01
2.435198383529411648e-01 3.191892589882353026e-01 7.716722767647058445e-01
2.480912178039215710e-01 3.260130233176470882e-01 7.776686513529411648e-01
2.526625972549019217e-01 3.328367876470588183e-01 7.836650259411764852e-01
2.572339767058823279e-01 3.396605519764706038e-01 7.896614005294116945e-01
2.618053561568627341e-01 3.464843163058823894e-01 7.956577751176470148e-01
2.663814683529411309e-01 3.533044084235294480e-01 8.016373194980391803e-01
2.711042956470587906e-01 3.600106619764705806e-01 8.070951274352941018e-01
2.758271229411764502e-01 3.667169155294117688e-01 8.125529353725490234e-01
2.805499502352941099e-01 3.734231690823529570e-01 8.180107433098039449e-01
2.852727775294117696e-01 3.801294226352941452e-01 8.234685512470588664e-01
2.899956048235293737e-01 3.868356761882352779e-01 8.289263591843136769e-01
2.947184321176470334e-01 3.935419297411764661e-01 8.343841671215685984e-01
2.994412594117646931e-01 4.002481832941176543e-01 8.398419750588235200e-01
3.041742870039215729e-01 4.069448828392156492e-01 8.452627266980392573e-01
3.090603190666666444e-01 4.134982722666666333e-01 8.501276338666666765e-01
3.139463511294117715e-01 4.200516616941176173e-01 8.549925410352940958e-01
3.188323831921568430e-01 4.266050511215686014e-01 8.598574482039216260e-01
3.237184152549019700e-01 4.331584405490195855e-01 8.647223553725490452e-01
3.286044473176470415e-01 4.397118299764705696e-01 8.695872625411764645e-01
3.334904793803921685e-01 4.462652194039215536e-01 8.744521697098038837e-01
3.383765114431372956e-01 4.528186088313725377e-01 8.793170768784313029e-01
3.432775234352941629e-01 4.593536347294117639e-01 8.841219216235294276e-01
3.483233414117647420e-01 4.657111465098038861e-01 8.883461629411764093e-01
3.533691593882353210e-01 4.720686582901960637e-01 8.925704042588235021e-01
3.584149773647059001e-01 4.784261700705882414e-01 8.967946455764705949e-01
3.634607953411764791e-01 4.847836818509804191e-01 9.010188868941176876e-01
3.685066133176470582e-01 4.911411936313725413e-01 9.052431282117646694e-01
3.735524312941176373e-01 4.974987054117647189e-01 9.094673695294117621e-01
3.785982492705882163e-01 5.038562171921568966e-01 9.136916108470588549e-01
3.836620657725490213e-01 5.101834172862745875e-01 9.178306732313725735e-01
3.888518719529411305e-01 5.162984355764705935e-01 9.213734830823528954e-01
3.940416781333332952e-01 5.224134538666667105e-01 9.249162929333333283e-01
3.992314843137254599e-01 5.285284721568628274e-01 9.284591027843137612e-01
4.044212904941176245e-01 5.346434904470588334e-01 9.320019126352940830e-01
4.096110966745097892e-01 5.407585087372549504e-01 9.355447224862745159e-01
4.148009028549019539e-01 5.468735270274510674e-01 9.390875323372549488e-01
4.199907090352941186e-01 5.529885453176470733e-01 9.426303421882352707e-01
4.251989701960784407e-01 5.590581797647059537e-01 9.460614570784313671e-01
4.305068882509803796e-01 5.648827414588235563e-01 9.488894191803921574e-01
4.358148063058823740e-01 5.707073031529411589e-01 9.517173812823529477e-01
4.411227243607843129e-01 5.765318648470588725e-01 9.545453433843137381e-01
4.464306424156863073e-01 5.823564265411764751e-01 9.573733054862745284e-01
4.517385604705881907e-01 5.881809882352940777e-01 9.602012675882352077e-01
4.570464785254901852e-01 5.940055499294117913e-01 9.630292296901959981e-01
4.623543965803921796e-01 5.998301116235293939e-01 9.658571917921567884e-01
4.676780946823529406e-01 6.055912316235293469e-01 9.685462810941175560e-01
4.730701729882352824e-01 6.110774376156862253e-01 9.706335882627450395e-01
4.784622512941176242e-01 6.165636436078431037e-01 9.727208954313725231e-01
4.838543295999999660e-01 6.220498495999999822e-01 9.748082026000000067e-01
4.892464079058823634e-01 6.275360555921568606e-01 9.768955097686274902e-01
4.946384862117646497e-01 6.330222615843136280e-01 9.789828169372548627e-01
5.000305645176470470e-01 6.385084675764706175e-01 9.810701241058823463e-01
5.054226428235293334e-01 6.439946735686274959e-01 9.831574312745098299e-01
5.108243242509803439e-01 6.493966148235293945e-01 9.850787763764706773e-01
5.162603025411763857e-01 6.544976105882353012e-01 9.864073998117647291e-01
5.216962808313725386e-01 6.595986063529412080e-01 9.877360232470588919e-01
5.271322591215685804e-01 6.646996021176470038e-01 9.890646466823529437e-01
5.325682374117646223e-01 6.698005978823529105e-01 9.903932701176471065e-01
5.380042157019606641e-01 6.749015936470587063e-01 9.917218935529411583e-01
5.434401939921568170e-01 6.800025894117647240e-01 9.930505169882353211e-01
5.488761722823528588e-01 6.851035851764705198e-01 9.943791404235294840e-01
5.543118699137253858e-01 6.900970112156862291e-01 9.955155482352940899e-01
5.597467255686273679e-01 6.947677280784313458e-01 9.960753091764705802e-01
5.651815812235293501e-01 6.994384449411763516e-01 9.966350701176470706e-01
5.706164368784313323e-01 7.041091618039215794e-01 9.971948310588235609e-01
5.760512925333333145e-01 7.087798786666666961e-01 9.977545920000000512e-01
5.814861481882352967e-01 7.134505955294117019e-01 9.983143529411764305e-01
5.869210038431372789e-01 7.181213123921568187e-01 9.988741138823529209e-01
5.923558594980392611e-01 7.227920292549019354e-01 9.994338748235294112e-01
5.977767754941176737e-01 7.273297248823529237e-01 9.997767317764705286e-01
6.031620679176470379e-01 7.315274773529412133e-01 9.995652785372548532e-01
6.085473603411764021e-01 7.357252298235293919e-01 9.993538252980391778e-01
6.139326527647058773e-01 7.399229822941176815e-01 9.991423720588235025e-01
6.193179451882353526e-01 7.441207347647058601e-01 9.989309188196078271e-01
6.247032376117647168e-01 7.483184872352941497e-01 9.987194655803921517e-01
6.300885300352940810e-01 7.525162397058823283e-01 9.985080123411764763e-01
6.354738224588235562e-01 7.567139921764706179e-01 9.982965591019608009e-01
6.408277823725490041e-01 7.607515064117646997e-01 9.978457748823529316e-01
6.461128107647058361e-01 7.644364965294117020e-01 9.968684625058823467e-01
6.513978391568626680e-01 7.681214866470587044e-01 9.958911501294117619e-01
6.566828675490196110e-01 7.718064767647058178e-01 9.949138377529411770e-01
6.619678959411764430e-01 7.754914668823529311e-01 9.939365253764705921e-01
6.672529243333333859e-01 7.791764569999999335e-01 9.929592130000000072e-01
6.725379527254902179e-01 7.828614471176470468e-01 9.919819006235294223e-01
6.778229811176470498e-01 7.865464372352940492e-01 9.910045882470588374e-01
6.830556815607843335e-01 7.900426268901959981e-01 9.897684281843137644e-01
6.881884831921568635e-01 7.931783792980391379e-01 9.880381043568627897e-01
6.933212848235293935e-01 7.963141317058822777e-01 9.863077805294118150e-01
6.984540864549019235e-01 7.994498841137254175e-01 9.845774567019608403e-01
7.035868880862745645e-01 8.025856365215685573e-01 9.828471328745097546e-01
7.087196897176470944e-01 8.057213889294116971e-01 9.811168090470587799e-01
7.138524913490196244e-01 8.088571413372548369e-01 9.793864852196078052e-01
7.189852929803921544e-01 8.119928937450979767e-01 9.776561613921568306e-01
7.240413718823529576e-01 8.149103926470587789e-01 9.756509706470588572e-01
7.289695795686274016e-01 8.174641357058823887e-01 9.731876683725489974e-01
7.338977872549018455e-01 8.200178787647058876e-01 9.707243660980392486e-01
7.388259949411764005e-01 8.225716218235293864e-01 9.682610638235293887e-01
7.437542026274509555e-01 8.251253648823528852e-01 9.657977615490196399e-01
7.486824103137253994e-01 8.276791079411764951e-01 9.633344592745097801e-01
7.536106179999999544e-01 8.302328509999999939e-01 9.608711570000000313e-01
7.585388256862745093e-01 8.327865940588234928e-01 9.584078547254901714e-01
7.633627801019606807e-01 8.350922218196078495e-01 9.556576765568627341e-01
7.680343643529411457e-01 8.370352195294117337e-01 9.524882182352940596e-01
7.727059486039214997e-01 8.389782172392156179e-01 9.493187599137254962e-01
7.773775328549019648e-01 8.409212149490196131e-01 9.461493015921568217e-01
7.820491171058823188e-01 8.428642126588234973e-01 9.429798432705882583e-01
7.867207013568627838e-01 8.448072103686274925e-01 9.398103849490195838e-01
7.913922856078431378e-01 8.467502080784313767e-01 9.366409266274509093e-01
7.960638698588236029e-01 8.486932057882352609e-01 9.334714683058823459e-01
8.006008472941177345e-01 8.503583215607842805e-01 9.300075603921568179e-01
8.049647588235294693e-01 8.516661605568627280e-01 9.261650744313725259e-01
8.093286703529410930e-01 8.529739995529411756e-01 9.223225884705882338e-01
8.136925818823529388e-01 8.542818385490196231e-01 9.184801025098039418e-01
8.180564934117646736e-01 8.555896775450980707e-01 9.146376165490196497e-01
8.224204049411765194e-01 8.568975165411765182e-01 9.107951305882353576e-01
8.267843164705882542e-01 8.582053555372548548e-01 9.069526446274509546e-01
8.311482279999999889e-01 8.595131945333333023e-01 9.031101586666666625e-01
8.353447113529411938e-01 8.605139972941175941e-01 8.989704099411764959e-01
8.393514427725490279e-01 8.611668256549019906e-01 8.944937634156863160e-01
8.433581741921567509e-01 8.618196540156862762e-01 8.900171168901961360e-01
8.473649056117646960e-01 8.624724823764705617e-01 8.855404703647059561e-01
8.513716370313725301e-01 8.631253107372548472e-01 8.810638238392157762e-01
8.553783684509803642e-01 8.637781390980391327e-01 8.765871773137254852e-01
8.593850998705881983e-01 8.644309674588235293e-01 8.721105307882353053e-01
8.633918312901960324e-01 8.650837958196078148e-01 8.676338842627451253e-01
8.674276350862745177e-01 8.643765997725489925e-01 8.626024620196078851e-01
8.714925112588235434e-01 8.623093793176470623e-01 8.570162640588235847e-01
8.755573874313725691e-01 8.602421588627450211e-01 8.514300660980392843e-01
8.796222636039215947e-01 8.581749384078430909e-01 8.458438681372549839e-01
8.836871397764705094e-01 8.561077179529411607e-01 8.402576701764707945e-01
8.877520159490196461e-01 8.540404974980391195e-01 8.346714722156862720e-01
8.918168921215686717e-01 8.519732770431371893e-01 8.290852742549019716e-01
8.958817682941176974e-01 8.499060565882352591e-01 8.234990762941176712e-01
8.995432066000000892e-01 8.475002359999999069e-01 8.177890744000000378e-01
9.028486703176471506e-01 8.447956505882352474e-01 8.119698337411764832e-01
9.061541340352941010e-01 8.420910651764705879e-01 8.061505930823529287e-01
9.094595977529411623e-01 8.393864797647058174e-01 8.003313524235293741e-01
9.127650614705882237e-01 8.366818943529411579e-01 7.945121117647058195e-01
9.160705251882352851e-01 8.339773089411764984e-01 7.886928711058823760e-01
9.193759889058823465e-01 8.312727235294118389e-01 7.828736304470588214e-01
9.226814526235294078e-01 8.285681381176470683e-01 7.770543897882352669e-01
9.255634230000000517e-01 8.255172980705882679e-01 7.711363078117646763e-01
9.281160096666666304e-01 8.221971488627450864e-01 7.651413492549019590e-01
9.306685963333333200e-01 8.188769996549020158e-01 7.591463906980392418e-01
9.332211830000000097e-01 8.155568504470588342e-01 7.531514321411764135e-01
9.357737696666665883e-01 8.122367012392157637e-01 7.471564735843139182e-01
9.383263563333332780e-01 8.089165520313725821e-01 7.411615150274509789e-01
9.408789429999999676e-01 8.055964028235294005e-01 7.351665564705882616e-01
9.434315296666666573e-01 8.022762536156862190e-01 7.291715979137255443e-01
9.455402989098039557e-01 7.986057405333333303e-01 7.231054172980392325e-01
9.473454035999999689e-01 7.946955047999999522e-01 7.169905058000000109e-01
9.491505082901960932e-01 7.907852690666666851e-01 7.108755943019607892e-01
9.509556129803922175e-01 7.868750333333333069e-01 7.047606828039215676e-01
9.527607176705882308e-01 7.829647976000000398e-01 6.986457713058823460e-01
9.545658223607843551e-01 7.790545618666666616e-01 6.925308598078431244e-01
9.563709270509803684e-01 7.751443261333333945e-01 6.864159483098039027e-01
9.581760317411764927e-01 7.712340904000000164e-01 6.803010368117646811e-01
9.595176584705882306e-01 7.669728545098039030e-01 6.741447150392156917e-01
9.605811984235294032e-01 7.625010185254902373e-01 6.679635471019607085e-01
9.616447383764705759e-01 7.580291825411764606e-01 6.617823791647058362e-01
9.627082783294117485e-01 7.535573465568627949e-01 6.556012112274509640e-01
9.637718182823529212e-01 7.490855105725491292e-01 6.494200432901962028e-01
9.648353582352940938e-01 7.446136745882352415e-01 6.432388753529412195e-01
9.658988981882352665e-01 7.401418386039215758e-01 6.370577074156862363e-01
9.669624381411764391e-01 7.356700026196077991e-01 6.308765394784313640e-01
9.675442976352941482e-01 7.308497161882352433e-01 6.246854782352940783e-01
9.678738483176471119e-01 7.258469080941176710e-01 6.184892347843137239e-01
9.682033989999999646e-01 7.208440999999999876e-01 6.122929913333333696e-01
9.685329496823529283e-01 7.158412919058823043e-01 6.060967478823529042e-01
9.688625003647058920e-01 7.108384838117647320e-01 5.999005044313725499e-01
9.691920510470588557e-01 7.058356757176470486e-01 5.937042609803920845e-01
9.695216017294117083e-01 7.008328676235293653e-01 5.875080175294117302e-01
9.698511524117646720e-01 6.958300595294116819e-01 5.813117740784313758e-01
9.696829796666666113e-01 6.904839307372548918e-01 5.751383613647058635e-01
9.692885689999999332e-01 6.849817470823529320e-01 5.689753262588235216e-01
9.688941583333333663e-01 6.794795634274509721e-01 5.628122911529411798e-01
9.684997476666666882e-01 6.739773797725490123e-01 5.566492560470588380e-01
9.681053370000000102e-01 6.684751961176471635e-01 5.504862209411766072e-01
9.677109263333333322e-01 6.629730124627450927e-01 5.443231858352941543e-01
9.673165156666666542e-01 6.574708288078431329e-01 5.381601507294118125e-01
9.669221049999999762e-01 6.519686451529411730e-01 5.319971156235294707e-01
9.660167198392156651e-01 6.461297415882352180e-01 5.258903482588235256e-01
9.649113881372548551e-01 6.401590780588234386e-01 5.198055987058823879e-01
9.638060564352940451e-01 6.341884145294117703e-01 5.137208491529412502e-01
9.627007247333333462e-01 6.282177509999999909e-01 5.076360996000000014e-01
9.615953930313725362e-01 6.222470874705882116e-01 5.015513500470588637e-01
9.604900613294117262e-01 6.162764239411764322e-01 4.954666004941176705e-01
9.593847296274509162e-01 6.103057604117647639e-01 4.893818509411764772e-01
9.582793979254902172e-01 6.043350968823529845e-01 4.832971013882353395e-01
9.566532109764706027e-01 5.980338227176470456e-01 4.773022923529411932e-01
9.548534056117646829e-01 5.916223450078431645e-01 4.713374634901961180e-01
9.530536002470587631e-01 5.852108672980391724e-01 4.653726346274509873e-01
9.512537948823529543e-01 5.787993895882352913e-01 4.594078057647059121e-01
9.494539895176471456e-01 5.723879118784315212e-01 4.534429769019610035e-01
9.476541841529411148e-01 5.659764341686274181e-01 4.474781480392157063e-01
9.458543787882353060e-01 5.595649564588235370e-01 4.415133191764706311e-01
9.440545734235293862e-01 5.531534787490196559e-01 4.355484903137255004e-01
9.417279298235293750e-01 5.464134770196078517e-01 4.297070703725490159e-01
9.392537715176471069e-01 5.395814885647058912e-01 4.239002049294117724e-01
9.367796132117647279e-01 5.327495001098039307e-01 4.180933394862745289e-01
9.343054549058823488e-01 5.259175116549019702e-01 4.122864740431372854e-01
9.318312965999999697e-01 5.190855232000000097e-01 4.064796085999999864e-01
9.293571382941177017e-01 5.122535347450980492e-01 4.006727431568627429e-01
9.268829799882353226e-01 5.054215462901960887e-01 3.948658777137254994e-01
9.244088216823529436e-01 4.985895578352941282e-01 3.890590122705882559e-01
9.214062212274509722e-01 4.914204171843137292e-01 3.834084353764705688e-01
9.182816725843137018e-01 4.841734721803921393e-01 3.777939250705882324e-01
9.151571239411764314e-01 4.769265271764706049e-01 3.721794147647058959e-01
9.120325752980392719e-01 4.696795821725490150e-01 3.665649044588235594e-01
9.089080266549020015e-01 4.624326371686276471e-01 3.609503941529413340e-01
9.057834780117647311e-01 4.551856921647058907e-01 3.553358838470588310e-01
9.026589293686274607e-01 4.479387471607843008e-01 3.497213735411764945e-01
8.995343807254901902e-01 4.406918021568627108e-01 3.441068632352941581e-01
8.958845948352941457e-01 4.330745567058823520e-01 3.386806345176470723e-01
8.921375427882353160e-01 4.253887370980392046e-01 3.332892727607843497e-01
8.883904907411764862e-01 4.177029174901960573e-01 3.278979110039215716e-01
8.846434386941176564e-01 4.100170978823529655e-01 3.225065492470588491e-01
8.808963866470588266e-01 4.023312782745098182e-01 3.171151874901961265e-01
8.771493345999999969e-01 3.946454586666666708e-01 3.117238257333333484e-01
8.734022825529411671e-01 3.869596390588235235e-01 3.063324639764706259e-01
8.696552305058823373e-01 3.792738194509804317e-01 3.009411022196078478e-01
8.653913329372548979e-01 3.711276720470588208e-01 2.957689564156862905e-01
8.610536002941175937e-01 3.629157635294117945e-01 2.906281271764705743e-01
8.567158676509804005e-01 3.547038550117647127e-01 2.854872979372549135e-01
8.523781350078430963e-01 3.464919464941176308e-01 2.803464686980391973e-01
8.480404023647060141e-01 3.382800379764708265e-01 2.752056394588237032e-01
8.437026697215685989e-01 3.300681294588235226e-01 2.700648102196078204e-01
8.393649370784314057e-01 3.218562209411764408e-01 2.649239809803921597e-01
8.350272044352941014e-01 3.136443124235294144e-01 2.597831517411764435e-01
8.301865219490196512e-01 3.047327635529411549e-01 2.548914280666666476e-01
8.252938101686274619e-01 2.957488380941176165e-01 2.500254739333332976e-01
8.204010983882352726e-01 2.867649126352940780e-01 2.451595198000000031e-01
8.155083866078431942e-01 2.777809871764705951e-01 2.402935656666666531e-01
8.106156748274510049e-01 2.687970617176470567e-01 2.354276115333333308e-01
8.057229630470588155e-01 2.598131362588235183e-01 2.305616574000000085e-01
8.008302512666666262e-01 2.508292107999999798e-01 2.256957032666666585e-01
7.959375394862745479e-01 2.418452853411764691e-01 2.208297491333333362e-01
7.905615319411765096e-01 2.313969990588235215e-01 2.162420382941176444e-01
7.851533046784313630e-01 2.208510887215686114e-01 2.116728770078431243e-01
7.797450774156863273e-01 2.103051783843137290e-01 2.071037157215686320e-01
7.743368501529411807e-01 1.997592680470588189e-01 2.025345544352941118e-01
7.689286228901962561e-01 1.892133577098042141e-01 1.979653931490197305e-01
7.635203956274509984e-01 1.786674473725490264e-01 1.933962318627450994e-01
7.581121683647059628e-01 1.681215370352940885e-01 1.888270705764705792e-01
7.527039411019608162e-01 1.575756266980392062e-01 1.842579092901960869e-01
7.468380122117647124e-01 1.400210194823529319e-01 1.799960969568627500e-01
7.409573187529412408e-01 1.222403252705882293e-01 1.757441991058823483e-01
7.350766252941176582e-01 1.044596310588235127e-01 1.714923012549019465e-01
7.291959318352940755e-01 8.667893684705881008e-02 1.672404034039215726e-01
7.233152383764706039e-01 6.889824263529410742e-02 1.629885055529411708e-01
7.174345449176470213e-01 5.111754842352939088e-02 1.587366077019607691e-01
7.115538514588235497e-01 3.333685421176468822e-02 1.544847098509803951e-01
7.056731579999999671e-01 1.555615999999999943e-02 1.502328119999999934e-01"""
hot_data="""
4.159999999999999809e-02 0.000000000000000000e+00 0.000000000000000000e+00
5.189484405443484799e-02 0.000000000000000000e+00 0.000000000000000000e+00
6.218968810886969789e-02 0.000000000000000000e+00 0.000000000000000000e+00
7.248453216330454085e-02 0.000000000000000000e+00 0.000000000000000000e+00
8.277937621773939769e-02 0.000000000000000000e+00 0.000000000000000000e+00
9.307422027217424065e-02 0.000000000000000000e+00 0.000000000000000000e+00
1.033690643266090836e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.136639083810439266e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.239587524354787834e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.342535964899136403e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.445484405443484555e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.548432845987833262e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.651381286532181969e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.754329727076530121e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.857278167620878551e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.960226608165226980e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.063175048709575687e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.166123489253924117e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.269071929798272547e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.372020370342620976e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.474968810886969406e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.577917251431318113e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.680865691975666820e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.783814132520014972e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.886762573064363679e-01 0.000000000000000000e+00 0.000000000000000000e+00
2.989711013608711276e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.092659454153060539e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.195607894697408691e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.298556335241756843e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.401504775786106105e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.504453216330454257e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.607401656874802409e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.710350097419151671e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.813298537963498713e-01 0.000000000000000000e+00 0.000000000000000000e+00
3.916246978507847976e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.019195419052196128e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.122143859596545390e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.225092300140892432e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.328040740685241694e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.430989181229590956e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.533937621773939108e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.636886062318286150e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.739834502862636523e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.842782943406984675e-01 0.000000000000000000e+00 0.000000000000000000e+00
4.945731383951332827e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.048679824495680979e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.151628265040029131e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.254576705584378393e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.357525146128727656e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.460473586673073587e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.563422027217422849e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.666370467761772112e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.769318908306120264e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.872267348850468416e-01 0.000000000000000000e+00 0.000000000000000000e+00
5.975215789394816568e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.078164229939165830e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.181112670483513982e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.284061111027862134e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.387009551572211397e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.489957992116560659e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.592906432660907701e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.695854873205255853e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.798803313749605115e-01 0.000000000000000000e+00 0.000000000000000000e+00
6.901751754293953267e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.004700194838302529e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.107648635382650681e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.210597075926997723e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.313545516471346986e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.416493957015696248e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.519442397560044400e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.622390838104392552e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.725339278648741814e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.828287719193089966e-01 0.000000000000000000e+00 0.000000000000000000e+00
7.931236159737438118e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.034184600281785160e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.137133040826135533e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.240081481370483685e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.343029921914832947e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.445978362459181099e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.548926803003528141e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.651875243547877403e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.754823684092225555e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.857772124636572597e-01 0.000000000000000000e+00 0.000000000000000000e+00
8.960720565180922970e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.063669005725272232e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.166617446269619274e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.269565886813968536e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.372514327358316688e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.475462767902665950e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.578411208447014102e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.681359648991361144e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.784308089535710407e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.887256530080058559e-01 0.000000000000000000e+00 0.000000000000000000e+00
9.990204970624407821e-01 0.000000000000000000e+00 0.000000000000000000e+00
1.000000000000000000e+00 9.314668687192773078e-03 0.000000000000000000e+00
1.000000000000000000e+00 1.960876960633760324e-02 0.000000000000000000e+00
1.000000000000000000e+00 2.990287052548243341e-02 0.000000000000000000e+00
1.000000000000000000e+00 4.019697144462726357e-02 0.000000000000000000e+00
1.000000000000000000e+00 5.049107236377194802e-02 0.000000000000000000e+00
1.000000000000000000e+00 6.078517328291692390e-02 0.000000000000000000e+00
1.000000000000000000e+00 7.107927420206175406e-02 0.000000000000000000e+00
1.000000000000000000e+00 8.137337512120658423e-02 0.000000000000000000e+00
1.000000000000000000e+00 9.166747604035141439e-02 0.000000000000000000e+00
1.000000000000000000e+00 1.019615769594962446e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.122556778786410747e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.225497787977859188e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.328438797169305963e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.431379806360755791e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.534320815552203954e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.637261824743652394e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.740202833935100557e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.843143843126548997e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.946084852317997160e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.049025861509445601e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.151966870700892376e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.254907879892342204e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.357848889083790644e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.460789898275238807e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.563730907466686970e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.666671916658135411e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.769612925849583851e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.872553935041032291e-01 0.000000000000000000e+00
1.000000000000000000e+00 2.975494944232479066e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.078435953423928617e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.181376962615377058e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.284317971806825498e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.387258980998273383e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.490199990189721824e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.593140999381170264e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.696082008572618705e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.799023017764066590e-01 0.000000000000000000e+00
1.000000000000000000e+00 3.901964026955515030e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.004905036146960695e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.107846045338411911e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.210787054529859796e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.313728063721308237e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.416669072912756677e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.519610082104205118e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.622551091295653558e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.725492100487101443e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.828433109678549884e-01 0.000000000000000000e+00
1.000000000000000000e+00 4.931374118869998324e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.034315128061446210e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.137256137252894650e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.240197146444343090e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.343138155635791531e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.446079164827239971e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.549020174018688412e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.651961183210133521e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.754902192401584182e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.857843201593032623e-01 0.000000000000000000e+00
1.000000000000000000e+00 5.960784210784481063e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.063725219975929503e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.166666229167377944e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.269607238358826384e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.372548247550274825e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.475489256741723265e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.578430265933171706e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.681371275124619036e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.784312284316067476e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.887253293507515917e-01 0.000000000000000000e+00
1.000000000000000000e+00 6.990194302698964357e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.093135311890412797e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.196076321081861238e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.299017330273306348e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.401958339464758119e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.504899348656205449e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.607840357847653889e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.710781367039102330e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.813722376230550770e-01 0.000000000000000000e+00
1.000000000000000000e+00 7.916663385421999211e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.019604394613447651e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.122545403804896091e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.225486412996344532e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.328427422187791862e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.431368431379240302e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.534309440570688743e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.637250449762137183e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.740191458953585624e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.843132468145034064e-01 0.000000000000000000e+00
1.000000000000000000e+00 8.946073477336479174e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.049014486527930945e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.151955495719379385e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.254896504910826716e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.357837514102275156e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.460778523293723596e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.563719532485172037e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.666660541676620477e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.769601550868068918e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.872542560059517358e-01 0.000000000000000000e+00
1.000000000000000000e+00 9.975483569250965799e-01 0.000000000000000000e+00
1.000000000000000000e+00 1.000000000000000000e+00 1.176371764607068646e-02
1.000000000000000000e+00 1.000000000000000000e+00 2.720490955785083084e-02
1.000000000000000000e+00 1.000000000000000000e+00 4.264610146963097870e-02
1.000000000000000000e+00 1.000000000000000000e+00 5.808729338141112308e-02
1.000000000000000000e+00 1.000000000000000000e+00 7.352848529319126747e-02
1.000000000000000000e+00 1.000000000000000000e+00 8.896967720497098164e-02
1.000000000000000000e+00 1.000000000000000000e+00 1.044108691167515562e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.198520610285317006e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.352932529403118589e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.507344448520920033e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.661756367638721477e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.816168286756522920e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.970580205874324364e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.124992124992125808e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.279404044109927252e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.433815963227728696e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.588227882345530140e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.742639801463331861e-01
1.000000000000000000e+00 1.000000000000000000e+00 2.897051720581133027e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.051463639698934749e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.205875558816735915e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.360287477934533196e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.514699397052338803e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.669111316170140524e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.823523235287941691e-01
1.000000000000000000e+00 1.000000000000000000e+00 3.977935154405743412e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.132347073523544578e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.286758992641346300e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.441170911759147466e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.595582830876949187e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.749994749994750354e-01
1.000000000000000000e+00 1.000000000000000000e+00 4.904406669112552075e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.058818588230353797e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.213230507348154408e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.367642426465956129e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.522054345583757851e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.676466264701559572e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.830878183819356853e-01
1.000000000000000000e+00 1.000000000000000000e+00 5.985290102937161905e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.139702022054963626e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.294113941172765347e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.448525860290567069e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.602937779408367680e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.757349698526169401e-01
1.000000000000000000e+00 1.000000000000000000e+00 6.911761617643971123e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.066173536761772844e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.220585455879573455e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.374997374997375177e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.529409294115176898e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.683821213232978620e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.838233132350779231e-01
1.000000000000000000e+00 1.000000000000000000e+00 7.992645051468580952e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.147056970586382674e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.301468889704179954e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.455880808821985006e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.610292727939786728e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.764704647057588449e-01
1.000000000000000000e+00 1.000000000000000000e+00 8.919116566175390171e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.073528485293190782e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.227940404410992503e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.382352323528794225e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.536764242646595946e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.691176161764396557e-01
1.000000000000000000e+00 1.000000000000000000e+00 9.845588080882198279e-01
1.000000000000000000e+00 1.000000000000000000e+00 1.000000000000000000e+00
"""
setup()

